{
  "permissions": {
    "allow": [
      "Bash(npm run:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nfeat(payments): implement ticket payment module for winners\n\nAdd complete payment system for winning tickets with RBAC support:\n\n## Types & Hooks\n- types/payment.types.ts: Payment, TicketPayment, PaymentMethod types\n- hooks/useTicketPayments.ts: React Query hooks for:\n  - usePendingWinningTicketsQuery: Fetch evaluated winner tickets\n  - useCreatePaymentMutation: Register payment (POST /ticket-payments)\n  - useReversePaymentMutation: Reverse payment\n  - useTicketPaymentHistoryQuery: Payment history\n  - usePaymentListQuery: Paginated payment list\n\n## Components\n- PendingTicketsScreen: Filterable list of winner tickets with:\n  - Role-based filtering (VENDEDOR sees own, VENTANA sees all vendors)\n  - Multi-select for batch payments (VENTANA only)\n  - Total payout, paid, remaining amounts\n  - Status indicators (PAGADO/PENDIENTE)\n\n- PaymentFormModal: Payment registration form with:\n  - Amount validation (â‰¤ remaining payout)\n  - Payment method selection (CASH|CHECK|TRANSFER|SYSTEM)\n  - Notes field (optional)\n  - \"Mark as final\" checkbox for partial payments\n  - Auto-generated idempotencyKey (UUID)\n\n- PaymentHistoryModal: Payment history table with:\n  - All payments for a ticket (active & reversed)\n  - Totals: paid, reversed, remaining\n  - Reverse button (ADMIN only)\n  - Partial payment details\n\n- PaymentConfirmationModal: Post-payment confirmation with:\n  - Payment ID, amount, method, date/time\n  - Success indicator with next steps\n  - Print receipt & register another buttons\n\n## Route\n- app/pagos/index.tsx: Main payments module\n  - Permission check (VENDEDOR/VENTANA/ADMIN)\n  - Orchestrates modals and navigation\n  - Handles payment flow: select â†’ form â†’ confirmation\n\n## Business Logic\n- VENDEDOR: Can only pay own tickets\n- VENTANA: Can pay tickets of all assigned vendors\n  - Payments tracked with vendorId for accountability\n- BANCA: Read-only access to payment history\n- Partial payments: Can register with remaining amount\n- Final payments: Can mark partial as intentionally final\n- Reversals: Can revert payments (ADMIN only)\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")"
    ],
    "deny": [],
    "ask": []
  }
}
